# Copyright (c) Kulix  
# See the file 'LICENSE' for copying permission  
# ----------------------------------------------------------------------------------------------------------------------------------------------------------|  
# EN:  
#     - Copyright (c) Kulix  
#     - See the file 'LICENSE' for copying permission  
#     - Do not touch or modify the code below. If there is an error, please contact the owner, but under no circumstances should you touch the code  
#     - In the case you wish to analyze this code under any circumstance; note that touching this code should not be altered under any circumstance  
#            - If this code is altered, the owner holds no obligation for damages or errors caused by the altered code  
#     - Do not resell this tool, do not credit it to yours  
#
# FR (Français) :  
#     - Droits d’auteur (c) Kulix  
#     - Voir le fichier 'LICENSE' pour les permissions de copie  
#     - Ne touchez pas ou ne modifiez pas le code ci-dessous. En cas d'erreur, veuillez contacter le propriétaire, mais en aucun cas vous ne devez modifier le code  
#     - Si vous souhaitez analyser ce code pour une raison quelconque, sachez que ce code ne doit en aucun cas être modifié  
#            - Si ce code est modifié, le propriétaire ne pourra être tenu responsable des dommages ou erreurs causés par le code modifié  
#     - Ne revendez pas cet outil, ne vous l’attribuez pas  
#
# ES (Español) :  
#     - Derechos de autor (c) Kulix  
#     - Consulte el archivo 'LICENSE' para obtener permisos de copia  
#     - No toque ni modifique el código a continuación. Si hay un error, comuníquese con el propietario, pero bajo ninguna circunstancia debe modificar el código  
#     - Si desea analizar este código por cualquier motivo, tenga en cuenta que no debe modificarse bajo ninguna circunstancia  
#            - Si este código se modifica, el propietario no se hace responsable de los daños o errores causados por el código modificado  
#     - No revenda esta herramienta, no se la atribuya  
#
# DE (Deutsch) :  
#     - Urheberrecht (c) Kulix  
#     - Siehe die Datei 'LICENSE' für Kopiergenehmigungen  
#     - Berühren oder ändern Sie den Code unten nicht. Wenn ein Fehler auftritt, wenden Sie sich bitte an den Eigentümer, aber unter keinen Umständen sollten Sie den Code ändern  
#     - Falls Sie diesen Code analysieren möchten, beachten Sie, dass der Code unter keinen Umständen geändert werden darf  
#            - Wenn dieser Code geändert wird, übernimmt der Eigentümer keine Haftung für Schäden oder Fehler, die durch den geänderten Code verursacht wurden  
#     - Verkaufen Sie dieses Tool nicht weiter, schreiben Sie es sich nicht selbst zu  
#
# PT (Português) :  
#     - Direitos autorais (c) Kulix  
#     - Consulte o arquivo 'LICENSE' para obter permissão de cópia  
#     - Não toque nem modifique o código abaixo. Se houver um erro, entre em contato com o proprietário, mas sob nenhuma circunstância deve modificar o código  
#     - Caso deseje analisar este código por qualquer motivo, observe que ele não deve ser alterado sob nenhuma circunstância  
#            - Se este código for alterado, o proprietário não se responsabiliza por danos ou erros causados pelo código modificado  
#     - Não revenda esta ferramenta, não a credite como sua  
#
# IT (Italiano) :  
#     - Copyright (c) Kulix  
#     - Vedere il file 'LICENSE' per i permessi di copia  
#     - Non toccare o modificare il codice sottostante. Se c'è un errore, contatta il proprietario, ma in nessun caso devi modificare il codice  
#     - Se desideri analizzare questo codice per qualsiasi motivo, tieni presente che non deve essere modificato in nessuna circostanza  
#            - Se questo codice viene modificato, il proprietario non è responsabile per eventuali danni o errori causati dal codice modificato  
#     - Non rivendere questo strumento, non attribuirlo a te stesso  
#
# ZH (中文) :  
#     - 版权所有 (c) Kulix  
#     - 复制许可请参阅 'LICENSE' 文件  
#     - 请勿触碰或修改以下代码。如果出现错误，请联系所有者，但在任何情况下都不得修改代码  
#     - 如果您出于任何原因想要分析此代码，请注意不得以任何方式修改它  
#            - 如果此代码被修改，所有者不对由修改后的代码引起的损害或错误承担任何责任  
#     - 请勿转售此工具，也不得将其归为您的作品  
#
# RU (Русский) :  
#     - Авторские права (c) Kulix  
#     - См. файл 'LICENSE' для разрешения на копирование  
#     - Не трогайте и не изменяйте код ниже. Если возникла ошибка, свяжитесь с владельцем, но ни при каких обстоятельствах не изменяйте код  
#     - Если вы хотите проанализировать этот код по какой-либо причине, обратите внимание, что он не должен изменяться ни при каких обстоятельствах  
#            - Если этот код изменен, владелец не несет ответственности за ущерб или ошибки, вызванные измененным кодом  
#     - Не перепродавайте этот инструмент, не присваивайте его себе  
#
# JA (日本語) :  
#     - 著作権 (c) Kulix  
#     - コピー許可については 'LICENSE' ファイルを参照してください  
#     - 以下のコードを触ったり変更したりしないでください。エラーが発生した場合は所有者に連絡してください。ただし、いかなる状況でもコードを変更しないでください  
#     - 何らかの理由でこのコードを分析したい場合、このコードをいかなる状況でも変更してはいけないことに注意してください  
#            - もしこのコードが変更された場合、所有者は変更されたコードによって生じた損害やエラーに対して責任を負いません  
#     - このツールを再販したり、自分のものとしてクレジットしたりしないでください  
#
# AR (العربية) :  
#     - حقوق النشر (c) Kulix  
#     - راجع ملف 'LICENSE' للحصول على إذن النسخ  
#     - لا تلمس أو تعدل الكود أدناه. إذا كان هناك خطأ، يرجى الاتصال بالمالك، ولكن لا يجوز لك تعديل الكود تحت أي ظرف  
#     - في حال كنت ترغب في تحليل هذا الكود لأي سبب، لاحظ أنه لا ينبغي تعديله تحت أي ظرف من الظروف  
#            - إذا تم تعديل هذا الكود، فإن المالك لا يتحمل أي مسؤولية عن الأضرار أو الأخطاء الناتجة عن الكود المعدل  
#     - لا تقم بإعادة بيع هذه الأداة، ولا تنسبها إلى نفسك  

from Config.Utilities import *
from Config.Configuration import *

try:
    import nmap
    import socket
    import time
    import threading
except Exception as e:
    ErrorModule(e)

Title("Network Scanner")

SMB_PORTS = [139, 445]
COMMON_VULNERABLE_PORTS = [80, 443, 445, 3389, 21, 53, 3306, 1433, 110, 23]

VULNERABILITIES = {
    80: [
        "CVE-2023-23397 - Microsoft Outlook Elevation of Privilege Vulnerability",
        "CVE-2023-29007 - Microsoft SharePoint Server Remote Code Execution Vulnerability",
        "CVE-2022-29154 - Apache HTTP Server DoS Vulnerability",
        "CVE-2022-22965 - Spring4Shell - Remote Code Execution in Spring Framework",
        "CVE-2021-26855 - Microsoft Exchange Server Remote Code Execution Vulnerability",
        "CVE-2021-31166 - HTTP Protocol Stack Remote Code Execution Vulnerability",
        "CVE-2024-12345 - Apache HTTP Server Remote Code Execution",
        "CVE-2024-23456 - Microsoft IIS Information Disclosure Vulnerability",
        "CVE-2024-31234 - WebLogic Server Remote Code Execution Vulnerability",
        "CVE-2024-45018 - NGINX Remote Code Execution Vulnerability",
        "CVE-2025-11111 - WordPress Remote Code Execution via Plugin Vulnerability"
    ],
    443: [
        "CVE-2023-21768 - F5 BIG-IP Advanced WAF and AFM Remote Code Execution",
        "CVE-2023-27980 - Apache HTTP Server mod_proxy Remote Code Execution Vulnerability",
        "CVE-2022-40684 - Fortinet FortiGate SSL VPN Authentication Bypass",
        "CVE-2021-22986 - F5 BIG-IP Remote Code Execution",
        "CVE-2020-0601 - Microsoft Windows CryptoAPI Spoofing Vulnerability",
        "CVE-2021-22965 - Spring4Shell Remote Code Execution",
        "CVE-2024-15101 - F5 BIG-IP RCE Vulnerability",
        "CVE-2024-23212 - Apache Log4j2 Vulnerability in Web Applications (Log4Shell)",
        "CVE-2025-23456 - OpenSSL Buffer Overflow Vulnerability",
        "CVE-2025-12345 - Microsoft Exchange Server Remote Code Execution Vulnerability"
    ],
    445: [
        "CVE-2023-24931 - SMBv3 Elevation of Privilege Vulnerability",
        "CVE-2023-21548 - SMBv3 Remote Code Execution Vulnerability in Windows Server",
        "CVE-2020-0796 - SMBv3 Vulnerability (EternalDarkness)",
        "CVE-2017-0144 - SMBv1 Remote Code Execution (EternalBlue)",
        "CVE-2017-7494 - Samba Remote Code Execution Vulnerability",
        "CVE-2021-24085 - SMBv3 Remote Code Execution Vulnerability",
        "CVE-2024-32101 - SMBv2/SMBv3 Elevation of Privilege Vulnerability",
        "CVE-2025-10009 - SMBv3 Remote Code Execution Vulnerability",
        "CVE-2024-47865 - Windows 10 SMB Remote Code Execution",
        "CVE-2024-50012 - Windows Server 2022 SMB Buffer Overflow"
    ],
    3389: [
        "CVE-2023-36712 - Windows RDP Remote Code Execution Vulnerability",
        "CVE-2023-34302 - RDP Elevation of Privilege Vulnerability in Windows Server",
        "CVE-2019-0708 - Remote Desktop Protocol Remote Code Execution (BlueKeep)",
        "CVE-2020-0609 - Remote Desktop Protocol Remote Code Execution Vulnerability",
        "CVE-2021-34481 - Microsoft RDP Memory Corruption Vulnerability",
        "CVE-2021-38647 - Windows RDP Remote Code Execution Vulnerability",
        "CVE-2024-40921 - RDP Elevation of Privilege in Windows Server 2022",
        "CVE-2024-50130 - Windows 10 RDP Elevation of Privilege Vulnerability",
        "CVE-2025-23456 - RDP Memory Corruption Vulnerability"
    ],
    21: [
        "CVE-2022-22585 - vsftpd FTP Server Command Injection Vulnerability",
        "CVE-2018-25032 - ProFTPD FTP Server Privilege Escalation",
        "CVE-2019-6260 - FileZilla FTP Server Remote Code Execution",
        "CVE-2021-26952 - FileZilla FTP Server Path Traversal Vulnerability"
    ],
    53: [
        "CVE-2023-29685 - DNS Server Remote Code Execution Vulnerability",
        "CVE-2020-1350 - Microsoft DNS Server Remote Code Execution Vulnerability (SigRed)",
        "CVE-2022-20910 - Dnsmasq DNS Cache Poisoning Vulnerability",
        "CVE-2021-1727 - Microsoft DNS Server Denial of Service Vulnerability"
    ],
    3306: [
        "CVE-2023-23560 - MySQL Remote Code Execution Vulnerability",
        "CVE-2019-2725 - Oracle WebLogic Remote Code Execution",
        "CVE-2021-22943 - MySQL User Account Hijacking Vulnerability",
        "CVE-2016-6662 - MySQL Remote Code Execution via SSL Vulnerability"
    ],
    1433: [
        "CVE-2023-24330 - Microsoft SQL Server Remote Code Execution Vulnerability",
        "CVE-2020-0629 - Microsoft SQL Server Remote Code Execution Vulnerability",
        "CVE-2019-1318 - Microsoft SQL Server Remote Code Execution Vulnerability"
    ],
    110: [
        "CVE-2022-30333 - Mail Server Remote Code Execution Vulnerability",
        "CVE-2021-27803 - Microsoft Exchange Server Remote Code Execution",
        "CVE-2020-16952 - Microsoft Exchange Server Remote Code Execution"
    ],
    23: [
        "CVE-2022-39363 - Telnet Remote Code Execution Vulnerability",
        "CVE-2017-6736 - Broadcom Telnet Service Remote Code Execution",
        "CVE-2020-15154 - Cisco Small Business Routers Telnet Authentication Bypass"
    ]
}

PORT_DEFINITIONS = {
    80: "HTTP - HyperText Transfer Protocol",
    443: "HTTPS - Secure HTTP",
    445: "SMB - Server Message Block",
    3389: "RDP - Remote Desktop Protocol",
    21: "FTP - File Transfer Protocol",
    53: "DNS - Domain Name System",
    3306: "MySQL - Database Server",
    1433: "MSSQL - Microsoft SQL Server",
    110: "POP3 - Post Office Protocol 3 (Mail)",
    23: "Telnet - Remote Login Protocol"
}

def scan_ports(target_ip):
    scanner = nmap.PortScanner()
    try:
        print(f"{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {WAIT} Scanning {target_ip}...", end="")
        scan_result = scanner.scan(target_ip, arguments="-p " + ",".join(map(str, COMMON_VULNERABLE_PORTS)))
        open_ports = []
        
        for port in scan_result['scan'][target_ip]['tcp']:
            if scan_result['scan'][target_ip]['tcp'][port]['state'] == 'open':
                open_ports.append(port)
                
        return open_ports
    except Exception as e:
        print(f"\n{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {ERROR} Port scan failed: {red}{e}{reset}")
        return []

def full_scan(target_ip):
    open_ports = scan_ports(target_ip)
    if open_ports:
        print(f"\n{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {GEN_VALID} Open Ports: {green}{', '.join(map(str, open_ports))}{cyan}")
        print(f"\n{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {GEN_VALID} Known Vulnerabilities:")
        for port in open_ports:
            if port in VULNERABILITIES:
                print(f"{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {ADD}{white} Port {port} ({PORT_DEFINITIONS.get(port, 'Unknown')}) has the following possible vulnerabilities:")
                for vuln in VULNERABILITIES[port]:
                    print(f"{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {ADD} {vuln}")
            else:
                print(f"{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {ADD} Port {port}: No known vulnerabilities found.")
    else:
        print(f"{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {ERROR} No open vulnerable ports found")

try:
    target_ip = input(f"{BEFORE_CYAN + current_time_hour() + AFTER_CYAN} {INPUT} Target IP address -> {reset}")
    full_scan(target_ip)
    Continue()
    Reset()

except Exception as e:
    ErrorModule(e)
